jQuery(function(d){if("undefined"==typeof wcsatt_cart_params)return!1;var t=d(document),p=d(document.body);t.on("change",".wcsatt-options-cart [name^=convert_to_sub]",function(){var s=d(this),o=d("div.cart_totals"),r=d("table.shop_table.cart"),n=s.closest(".wcsatt-options-cart"),i=r.closest(".woocommerce"),t=o.find("input.wcsatt-add-cart-to-subscription-action-input"),a=s.val(),_=r.find('input[name="_wp_http_referer"]').val();i.block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var e={security:wcsatt_cart_params.update_cart_option_nonce,subscription_scheme:a,add_to_subscription_checked:t.is(":checked")?"yes":"no",action:"wcsatt_update_cart_option"};d.post(wcsatt_cart_params.wc_ajax_url.toString().replace("%%endpoint%%",e.action),e,function(t){if("success"===t.result){var a=d(d.parseHTML(t.html)),e=a.find("div.cart_totals"),c=a.find("table.shop_table.cart");_&&c.find('input[name="_wp_http_referer"]').val(_),c.find('input[name="update_cart"]').prop("disabled",!0),o.replaceWith(e),r.replaceWith(c),i.trigger("wcsatt_updated_cart"),p.trigger("updated_cart_totals")}else window.alert(wcsatt_cart_params.i18n_update_cart_sub_error),t.reset_to_scheme&&(s.is(":radio")?n.find('input[value="'+t.reset_to_scheme+'"]').prop("checked",!0):s.val(t.reset_to_scheme));i.unblock()})}),t.on("change",".wcsatt-add-cart-to-subscription-action-input",function(){var t=d("div.cart_totals"),a=d(this),e=a.closest(".wcsatt-add-cart-to-subscription-wrapper"),c=e.find(".wcsatt-add-cart-to-subscription-options"),s=t.find(".wcsatt-options-cart [name^=convert_to_sub]"),o=a.is(":checked"),r=s.val();if(o){e.block({message:null,overlayCSS:{background:"#fff",opacity:.6}});var n={subscription_scheme:r,add_to_subscription_checked:a.is(":checked")?"yes":"no",action:"wcsatt_load_subscriptions_matching_cart"};d.post(wcsatt_cart_params.wc_ajax_url.toString().replace("%%endpoint%%",n.action),n,function(t){"success"===t.result?(c.html(t.html),e.removeClass("closed"),e.addClass("open"),c.slideDown(200)):window.alert(wcsatt_cart_params.i18n_subs_load_error),e.unblock()})}else e.removeClass("open"),e.addClass("closed"),c.slideUp(200)})});